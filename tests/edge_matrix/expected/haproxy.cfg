# Autogenerated by edge_proxy_haproxy role. Do not edit manually.

global
  maxconn 2048

defaults
  mode http
  timeout connect 5s
  timeout client  50s
  timeout server  50s
  option httplog
  option dontlognull
  option http-server-close
  option forwardfor

frontend http_ingress
  bind *:80
  mode http
  acl host_app_one hdr(host) -i app-one.example.test
  use_backend app-one if host_app_one
  acl host_metrics hdr(host) -i metrics.example.test
  acl path_metrics path_beg /metrics
  use_backend metrics if host_metrics path_metrics

frontend https_ingress
  bind *:443 ssl crt /usr/local/etc/haproxy/tls.pem
  mode http
  acl host_tls_app_one hdr(host) -i app-one.example.test
  use_backend app-one if host_tls_app_one
  acl host_tls_metrics hdr(host) -i metrics.example.test
  acl path_tls_metrics path_beg /metrics
  use_backend metrics if host_tls_metrics path_tls_metrics

backend app-one
  mode http
  option httpchk
  http-check send meth GET uri /
  server app-one 198.51.100.10:8080 check

backend metrics
  mode http
  option httpchk
  http-check send meth GET uri /metrics
  server metrics 198.51.100.11:9090 check
