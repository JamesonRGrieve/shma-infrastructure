# Autogenerated by edge_proxy_traefik role. Do not edit manually.
http:
  routers:
{% for backend in edge_ingress_backends | default([]) %}
    {{ backend.router_name }}:
      entryPoints:
        - {{ backend.router_entrypoint }}
      rule: "Host(`{{ backend.exports.APP_FQDN }}`){% if backend.path_prefix != '/' %} && PathPrefix(`{{ backend.path_prefix }}`){% endif %}"
      service: {{ backend.service_id }}
{% if backend.tls %}
      tls:
{% if backend.tls_certresolver %}
        certResolver: {{ backend.tls_certresolver }}
{% endif %}
{% endif %}
{% if backend.middlewares %}
      middlewares:
{% for middleware in backend.middlewares %}
        - {{ middleware }}
{% endfor %}
{% endif %}
{% endfor %}
  services:
{% for backend in edge_ingress_backends | default([]) %}
    {{ backend.service_id }}:
      loadBalancer:
        passHostHeader: {{ backend.pass_host_header | default(true) | bool | lower }}
        servers:
          - url: "{{ backend.scheme }}://{{ backend.exports.APP_BACKEND_IP }}:{{ backend.exports.APP_PORT }}"
{% endfor %}
